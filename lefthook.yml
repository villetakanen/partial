# https://github.com/evilmartians/lefthook

pre-commit:
  parallel: true
  commands:
    biome-check:
      glob: "*.{js,ts,svelte,json}"
      run: pnpm exec biome check --staged --no-errors-on-unmatched
    biome-format:
      glob: "*.{js,ts,svelte,json}"
      run: pnpm exec biome format --staged --no-errors-on-unmatched

commit-msg:
  commands:
    conventional-commit:
      run: |
        commit_msg=$(cat {1})
        pattern="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\(.+\))?: .{1,72}"
        if ! echo "$commit_msg" | grep -Eq "$pattern"; then
          echo "‚ùå Commit message must follow Conventional Commits format:"
          echo "   <type>(<scope>): <description>"
          echo ""
          echo "   Types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
          echo ""
          echo "   Your message: $commit_msg"
          exit 1
        fi

pre-push:
  parallel: true
  commands:
    test:
      run: pnpm exec vitest --run
    typecheck:
      run: pnpm exec tsc --noEmit
    svelte-check:
      run: pnpm exec svelte-check --threshold error
